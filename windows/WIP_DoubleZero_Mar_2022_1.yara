rule WIP_DoubleZero_Mar_2022_1 : wiper doublezero
{
   meta:
      description = "Detect .NET wiper used during Ukrainian crisis against Ukraine infrastructures"
      author = "Arkbird_SOLG"
      reference = "https://cert.gov.ua/article/38088"
      date = "2022-03-22"
      hash1 = "30b3cbe8817ed75d8221059e4be35d5624bd6b5dc921d4991a7adc4c3eb5de4a"
      hash2 = "3b2e708eaa4744c76a633391cf2c983f4a098b46436525619e5ea44e105355fe"
      adversary = "UAC-0088"
      tlp = "Clear"
   strings:
      $s1 = { 28 78 00 00 0a 7e ?? 06 00 04 25 2d 17 26 7e ?? 06 00 04 fe 06 ?? 00 00 06 73 79 00 00 0a 25 80 ?? 06 00 04 28 04 00 00 2b 2a }
      $s2 = { 08 07 9a 74 01 00 00 1b 16 16 28 1b 00 00 06 0d 09 1f ?? 2e ?? 09 [2-5] 3b ?? 03 00 00 38 ?? 03 00 00 00 14 13 04 28 3b 00 00 0a 6f 3c 00 00 0a 13 05 16 13 06 1b 8d 0f 00 00 01 25 16 1f 0c 8d ?? 00 00 01 25 d0 [2] 00 04 28 10 00 00 0a a2 25 17 [1-2]8d ?? 00 00 01 25 d0 [2] 00 04 28 10 00 00 0a a2 25 18 1f ?? 8d ?? 00 00 01 25 d0 [2] 00 04 28 10 00 00 0a a2 25 19 [1-2] 8d ?? 00 00 01 25 d0 ?? 02 00 04 28 10 00 00 0a a2 25 1a 1f ?? 8d ?? 00 00 01 25 d0 [2] 00 04 28 10 00 00 0a a2 13 07 38 }
      $s3 = { 08 07 9a 74 01 00 00 1b 16 16 28 1f 00 00 06 0d 09 1f [9-10] 00 00 [2] 10 00 00 00 14 13 04 02 28 81 00 00 0a 13 05 16 13 06 1b 8d 0f 00 00 01 25 16 [1-2] 8d ?? 00 00 01 25 d0 ?? 05 00 04 28 10 00 00 0a a2 25 17 1f ?? 8d ?? 00 00 01 25 d0 [2] 00 04 28 10 00 00 0a a2 25 18 1c 8d ?? 00 00 01 25 d0 ?? 04 00 04 28 10 00 00 0a a2 25 19 1f ?? 8d ?? 00 00 01 25 d0 [2] 00 04 28 10 00 00 0a a2 25 1a 1f 0c 8d ?? 00 00 01 25 d0 [2] 00 04 28 10 00 00 0a a2 13 07 38 ?? 04 00 00 11 07 11 06 9a 74 01 00 00 1b 16 16 28 1f 00 00 06 13 0b 11 0b }
      $s4 = { 14 0a 16 0b 1f ?? 8d 0f 00 00 01 25 16 1f ?? 8d ?? 00 00 01 25 d0 ?? 02 00 04 28 10 00 00 0a a2 25 17 [4] 00 }
   condition:
      uint16(0) == 0x5A4D and filesize > 30KB and all of ($s*)
}
