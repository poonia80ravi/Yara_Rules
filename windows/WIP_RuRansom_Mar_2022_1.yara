rule WIP_RuRansom_Mar_2022_1 : wiper ruransom
{
   meta:
      description = "Detect wiper implant used during Ukrainian crisis against Russia"
      author = "Arkbird_SOLG"
      reference = "https://www.trendmicro.com/en_us/research/22/c/new-ruransom-wiper-targets-russia.html"
      date = "2022-03-10"
      hash1 = "8f2ea18ed82085574888a03547a020b7009e05ae0ecbf4e9e0b8fe8502059aae"
      hash2 = "696b6b9f43e53387f7cef14c5da9b6c02b6bf4095849885d36479f8996e7e473"
      hash3 = "107da216ad99b7c0171745fe7f826e51b27b1812d435b55c3ddb801e23137d8f"
      adversary = "-"
   strings:
      $s1 = { 9a [3-5] 6f ?? 00 00 0a 18 2e [2-3] 6f ?? 00 00 0a 1a fe 01 2b 01 17 13 ?? 11 ?? 2c ?? 00 [1-2] 6f ?? 00 00 0a 6f ?? 00 00 0a 28 }
      $s2 = { 02 72 ?? 00 00 70 28 ?? 00 00 0a 72 [2] 00 70 28 ?? 00 00 0a 28 ?? 00 00 0a 0a 06 39 9f 00 00 00 00 02 28 ?? 00 00 0a 0b 16 0d 2b 4f 00 07 09 9a 73 ?? 00 00 0a 13 04 07 09 9a 28 ?? 00 00 0a 6f ?? 00 00 0a 72 [2] 00 70 28 ?? 00 00 0a 13 05 11 05 2c 0b 00 07 09 9a 28 ?? 00 00 0a 00 00 11 04 20 80 00 00 00 6f ?? 00 00 0a 00 07 09 9a 02 28 ?? 00 00 06 00 00 09 17 58 0d 09 07 8e 69 fe 04 13 06 11 06 2d a5 02 28 ?? 00 00 0a 0c 16 13 07 2b 1c 00 08 11 07 9a 72 [2] 00 70 28 ?? 00 00 0a 28 ?? 00 00 06 00 00 11 07 17 58 13 07 11 07 08 8e 69 fe 04 13 08 11 08 2d d7 00 2b 02 00 00 00 de 05 26 00 00 de }
      $s3 = { 73 ?? 00 00 0a 0a 73 ?? 00 00 0a 0b 16 0c 2b 20 00 06 02 07 16 02 6f ?? 00 00 0a 6f ?? 00 00 0a 6f ?? 00 00 0a 6f ?? 00 00 0a 26 00 08 17 58 0c 08 02 6f ?? 00 00 0a fe 04 0d 09 2d d3 06 6f ?? 00 00 0a 13 04 2b 00 11 04 }
      $s4 = { 73 ?? 00 00 0a 0d 00 73 ?? 00 00 0a 13 04 00 11 04 20 00 01 00 00 6f ?? 00 00 0a 00 11 04 20 80 00 00 00 6f ?? 00 00 0a 00 03 06 20 00 02 00 00 73 ?? 00 00 0a 13 05 11 04 11 05 11 04 6f ?? 00 00 0a 1e 5b 6f ?? 00 00 0a 6f ?? 00 00 0a 00 11 04 11 05 11 04 6f ?? 00 00 0a 1e 5b 6f ?? 00 00 0a 6f ?? 00 00 0a 00 11 04 17 6f ?? 00 00 0a 00 09 11 04 6f ?? 00 00 0a 17 73 ?? 00 00 0a 13 06 00 11 06 02 16 02 8e 69 6f ?? 00 00 0a 00 11 06 6f ?? 00 00 0a 00 00 de 0d 11 06 2c 08 11 06 6f ?? 00 00 0a 00 dc 09 6f ?? 00 00 0a 0c de 18 11 04 2c 08 11 04 6f ?? 00 00 0a 00 dc 09 2c 07 09 6f ?? 00 00 0a }
   condition:
      uint16(0) == 0x5A4D and filesize > 5KB and all of ($s*)
}
