rule MAL_44Caliber_Feb_2022_1 : stealer
{
   meta:
        description = "Detect the 44caliber stealer"
        author = "Arkbird_SOLG"
        reference = "Internal Research"
        date = "2022-02-26"
        hash1 = "d986ff4dd8ec61ab72ded8a8f55da573a908454d812c20277f5e5857077a40d5"
        hash2 = "1e6906199e0133c35d7d891639129b1fdbaa5ccfd6495be821a19833b665089c"
        hash3 = "4b8d1d8710031235a7b7a7fb508fef60d75788d17a1234de27f6d94a544e9991"
        tlp = "Clear"
        adversary = "-"
   strings:
        $s1 = { 02 20 80 00 00 00 7d ?? 00 00 04 [0-1] 03 6f ?? 00 00 0a 0a 16 0b 38 ?? 01 00 00 06 07 6f ?? 00 00 0a 0c }
        $s2 = { 73 ?? 02 00 0a 0a [0-1] 02 72 [2] 00 70 28 [2] 00 06 0b 07 [0-6] 07 06 ?? dd ?? 00 00 00 16 }
        $s3 = { 7e ?? 03 00 04 0a 16 0b 38 ?? 00 00 00 06 07 9a 0c [0-2] 08 73 ?? 01 00 0a 6f ?? 01 00 0a 0d 02 72 [2] 00 70 09 28 ?? 00 00 0a 13 04 7e ?? 03 00 04 72 [2] 00 70 08 28 ?? 00 00 0a 13 05 11 05 72 [2] 00 70 28 ?? 00 00 0a 28 ?? 00 00 0a }
        $s4 = { 13 ?? 11 ?? 18 8d ?? 00 00 01 25 16 72 [2] 00 70 a2 25 17 72 [2] 00 70 a2 6f [2] 00 06 [0-1] 11 ?? 72 [0-1] 8f [0-1] 00 70 6f [2] 00 06 13 ?? 08 28 [2] 00 06 [2-7] 00 00 00 09 28 [2] 00 06 }
        $s5 = { 17 80 ?? 03 00 04 72 [2] 00 70 80 ?? 03 00 04 72 [2] 00 70 80 ?? 03 00 04 17 8d ?? 00 00 01 25 16 72 [2] 00 70 a2 80 ?? 03 00 04 20 d0 12 13 00 80 ?? 03 00 04 2a }
        $s6 = { 7e ?? 01 00 0a 72 [2] 00 70 6f ?? 01 00 0a 72 [2] 00 70 6f ?? 01 00 0a 72 [2] 00 70 6f ?? 01 00 0a [0-1] 02 72 [2] 00 70 28 ?? 00 00 0a 28 ?? 00 00 0a 26 [0-1] 72 [2] 00 70 6f ?? 01 00 0a 6f ?? 00 00 0a 72 [2] 00 70 28 ?? 00 00 0a 02 72 [2] 00 70 28 ?? 00 00 0a 28 ?? 01 00 0a [0-1] 7e ?? 03 00 04 17 58 80 ?? 03 00 04 7e [2] 00 04 17 58 80 [2] 00 04 [0-1] de ?? 26 [0-1] de 00 2a }
    condition:
        uint16(0) == 0x5A4D and filesize > 200KB and all of ($s*) 
}
