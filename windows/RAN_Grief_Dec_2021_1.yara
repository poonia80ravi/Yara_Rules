rule RAN_Grief_Dec_2021_1 {
   meta:
        description = "Detect Grief ransomware"
        author = "Arkbird_SOLG"
        reference = "Internal Research"
        date = "2021-12-22"
        hash1 = "b21ad8622623ce4bcdbf8c5794ef93e2fb6c46cd202d70dbeb088ea6ca4ff9c8"
        hash2 = "dda4598f29a033d2ec4f89f4ae687e12b927272462d25ca1b8dec4dc0acb1bec"
        hash3 = "c984451734c5ce00b12ac43741a59e52cb2e2949c703373e817275b85b8b2f61"
        tlp = "Clear"
        adversary = "Grief"
        level = "Experimental"
   strings:
        $s1 = { 83 e4 f8 81 ec ?? 00 00 00 8b 45 0c 8b 4d 08 c7 84 24 ?? 00 00 00 [4] c7 ?? 24 ?? 00 00 00 00 }
        $s2 = { e8 [3] 00 c7 44 24 ?? 1b 09 00 00 8b 44 24 2c 89 04 24 c7 44 24 04 00 00 00 00 c7 44 24 08 08 00 00 00 e8 [3] 00 }
        $s3 = { 31 c9 ba 08 00 00 00 be 14 00 00 00 8d 7c 24 ?? 89 3c 24 c7 44 24 04 00 00 00 00 c7 44 24 08 14 00 00 00 89 44 24 ?? 89 4c 24 ?? 89 54 24 ?? 89 74 24 [5] 00 c7 84 24 8c 00 00 00 1b 09 00 00 }
        $s4 = { 31 d2 89 e8 42 01 05 [3] 10 89 d8 42 01 05 [3] 10 89 f0 01 05 [3] 10 e8 [3] ff b8 00 00 00 00 b8 00 00 00 00 40 40 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 b8 00 00 00 00 }
   condition:
        uint16(0) == 0x5A4D and filesize > 80KB and all of ($s*) 
}

