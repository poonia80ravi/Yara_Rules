rule RAN_Hades_Dec_2021_1
{
    meta:
        description = "Detect the Hades ransomware"
        author = "Arkbird_SOLG"
        date = "2021-12-21"
        reference = "Internal Research"
        hash1 = "5eea7bdaad184396c6fc37909eaca623d79aa960b4e06078bdcbe0e904685a9d"
        hash2 = "fbb3316fa6994fd3c19dd45b98ffa5ff2c6249c08fcd832fa912bc305dcd8ffc"
        tlp = "Clear"
        adversary = "Hades"
    strings:
        $s1 = { 48 83 ec 58 8b 0d [3] 00 ba 01 14 00 00 ff 15 [3] 00 48 85 c0 74 07 33 c0 e9 c1 3b 00 00 48 8b 05 [3] 00 48 89 44 24 30 c7 44 24 3c 2c 01 00 00 c7 44 24 38 01 00 00 00 33 c9 ff 15 [3] 00 48 89 05 [3] 00 48 8b 05 [3] 00 48 63 48 3c 48 8b 05 [3] 00 48 03 c1 48 89 05 [3] 00 48 8d 44 24 3c 48 89 44 24 28 48 8d 05 [3] 00 48 89 44 24 20 4c 8d 4c 24 38 45 33 c0 48 8d 15 [3] 00 48 8b 0d [3] 00 ff 54 24 30 48 85 c0 74 05 e8 5e ff ff ff 48 8d 05 [2] 00 00 48 89 05 [3] 00 48 8b 05 [3] 00 48 83 c0 04 48 89 05 [3] 00 48 c7 44 24 48 [3] 00 48 c7 44 24 48 [3] 00 48 c7 44 24 48 [3] 00 48 c7 44 24 48 [3] 00 48 c7 44 24 48 [3] 00 48 c7 44 24 48 [3] 00 48 c7 44 24 48 [3] 00 48 c7 44 24 48 [3] 00 48 c7 44 24 48 [3] 00 48 c7 44 24 48 [3] 00 48 c7 44 24 48 [3] 00 48 c7 44 24 48 [3] 00 48 c7 44 24 48 [3] 00 48 c7 44 24 48 }
        $s2 = { 48 83 ec 58 48 c7 44 24 38 ff ff ff ff c7 44 24 30 [2] 00 00 8b 05 [3] 00 89 44 24 4c 48 }
        $s3 = { 48 89 05 [3] 00 b9 02 00 00 00 e8 [2] ff ff 89 05 [3] 00 48 8d 0d [3] 00 ff 15 [3] 00 48 8d 15 [3] 00 48 8b c8 ff 15 [3] 00 48 89 05 [3] 00 b9 01 00 00 00 e8 [3] ?? c7 05 [3] 00 00 00 00 00 8b 05 [3] 00 89 05 [3] 00 c7 05 [3] 00 ?? 00 00 00 c7 44 24 ?? 00 00 00 00 }
        $s4 = { cc cc cc cc cc cc cc 48 8b 05 [3] 00 48 89 05 [3] 00 c3 cc }
    condition:
      uint16(0) == 0x5A4D and filesize > 90KB and all of ($s*) 
}