rule RAN_Solidbit_Jun_2022_1 : solidbit ransomware
{
   meta:
        description = "Detect the Solidbit ransomware"
        author = "Arkbird_SOLG"
        reference = "Internal Research"
        date = "2022-06-28"
        hash1 = "63c9e7ec3a191e9ffbfc388a3cf7375693b609f4fd223b3fbcc9d7d21759b1bc"
        hash2 = "0f73ddb9dba894298b468d162f7dd49ae6f49cdc71184b98339d5b1e3eccbb02"
        hash3 = "eeb0a884d4eabc4f8811ecaa3e37acc8156c52b60a89537c5498df4c0e0c21f7"
        tlp = "Clear"
        adversary = "RAAS"
   strings:
        $s1 = { 08 45 08 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 d0 07 00 00 06 26 ?? 0c 2b d0 73 ?? 00 00 0a 0a 06 20 [5] 28 ?? 00 00 06 20 [2] 00 00 20 [2] 00 00 28 ?? 00 00 06 26 ?? 0c 2b aa 06 20 [5] 28 ?? 00 00 06 20 [2] 00 00 20 [2] 00 00 28 ?? 00 00 06 26 06 20 [5] 28 ?? 00 00 06 20 [2] 00 00 20 [2] 00 00 28 ?? 00 00 06 26 ?? 0c 38 6b ff ff ff 06 20 [5] 28 ?? 00 00 06 20 [2] 00 00 20 [2] 00 00 28 ?? 00 00 06 26 06 20 [5] 28 ?? 00 00 06 6f ?? 00 00 0a 26 ?? 0c 38 36 ff ff ff 06 6f ?? 00 00 0a 0b }
        $s2 = { 07 45 06 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 00 00 00 00 ?? 00 00 00 ?? 00 00 00 02 7b 0a 00 00 04 03 9a 73 ?? 00 00 0a 0a 06 25 20 [2] 00 00 20 [2] 00 00 28 ?? 00 00 06 20 7f ff ff ff 5f 20 [2] 00 00 20 [2] 00 00 28 ?? 00 00 06 ?? 0b 2b aa de 03 26 de 00 ?? 0c 08 45 05 00 00 00 ?? 00 00 00 18 00 00 00 ?? 00 00 00 00 00 00 00 ?? 00 00 00 02 7b 07 00 00 04 7b 05 00 00 04 02 7b 0a 00 00 04 03 9a 28 08 00 00 06 2a d0 24 00 00 06 }
        $s3 = { 13 0b 11 0b 45 0a 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 73 26 00 00 06 13 08 11 08 02 7d 0b 00 00 04 11 08 02 7b 07 00 00 04 7d 0c 00 00 04 ?? 13 0b 2b b0 11 08 02 7b 08 00 00 04 03 9a }
        $s4 = { 11 04 45 08 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 ?? 00 00 00 d0 ?? 00 00 06 26 ?? 13 04 2b ce 73 ?? 00 00 0a 0a 73 ?? 00 00 0a 0b ?? 13 04 2b bd 06 20 [5] 28 ?? 00 00 06 07 20 [5] 28 ?? 00 00 06 20 [2] 00 00 20 [2] 00 00 28 ?? 00 00 06 20 [2] 00 00 20 [2] 00 00 28 ?? 00 00 06 }
   condition:
       uint16(0) == 0x5A4D and filesize > 100KB and all of ($s*)
}
